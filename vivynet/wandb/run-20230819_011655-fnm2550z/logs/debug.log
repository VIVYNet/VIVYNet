2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Current SDK version is 0.15.8
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Configure stats pid to 232841
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Loading settings from /home/blherre4/.config/wandb/settings
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Loading settings from /home/blherre4/projects/vivy/VIVYNet/vivynet/wandb/settings
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-08-19 01:16:55,517 WARNING MainThread:232841 [wandb_setup.py:_flush():76] Could not save program above cwd: /home/blherre4/.conda/envs/vivyenv/bin/fairseq-train
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': None, 'program': '/home/blherre4/.conda/envs/vivyenv/bin/fairseq-train'}
2023-08-19 01:16:55,517 INFO    MainThread:232841 [wandb_init.py:_log_setup():507] Logging user logs to /home/blherre4/projects/vivy/VIVYNet/vivynet/wandb/run-20230819_011655-fnm2550z/logs/debug.log
2023-08-19 01:16:55,518 INFO    MainThread:232841 [wandb_init.py:_log_setup():508] Logging internal logs to /home/blherre4/projects/vivy/VIVYNet/vivynet/wandb/run-20230819_011655-fnm2550z/logs/debug-internal.log
2023-08-19 01:16:55,518 INFO    MainThread:232841 [wandb_init.py:init():547] calling init triggers
2023-08-19 01:16:55,518 INFO    MainThread:232841 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'tensorboard_logdir': './results/default/logs', 'seed': 1998, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': False, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': './', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'quantization_config_path': None, 'profile': False, 'criterion': 'nll_loss', 'tokenizer': None, 'bpe': None, 'optimizer': 'adam', 'lr_scheduler': 'polynomial_decay', 'scoring': 'bleu', 'task': 'text2music', 'num_workers': 1, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 1, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 1, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'broadcast_buffers': False, 'distributed_wrapper': 'DDP', 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'arch': 'vivy_transformer', 'max_epoch': 0, 'max_update': 0, 'stop_time_hours': 0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [1e-05], 'min_lr': -1.0, 'use_bmuf': False, 'save_dir': './results/default/ckpt', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'adam_betas': '(0.9, 0.98)', 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'data': '../data/final', 'shorten_method': 'none', 'shorten_data_split_list': '', 'tokens_per_sample': 4096, 'sample_break_mode': 'complete_doc', 'ratio': 4, 'sample_overlap_rate': 4, 'perm_inv': 3, 'evt_voc_size': 1125, 'trk_voc_size': 44, 'dur_voc_size': 36, 'ins_voc_size': 133, 'max_rel_pos': 198, 'max_mea_pos': 5360, 'pt_enc': 0, 'freeze_enc': 1, 'pt_dec': 0, 'freeze_dec': 0, 'no_seed_provided': False, 'dec_embed_dim': 512, 'dec_num_attention_heads': 32, 'dec_num_layers': 12, 'dec_dropout': 0.1, 'distributed_num_procs': 1}
2023-08-19 01:16:55,519 INFO    MainThread:232841 [wandb_init.py:init():596] starting backend
2023-08-19 01:16:55,519 INFO    MainThread:232841 [wandb_init.py:init():600] setting up manager
2023-08-19 01:16:55,526 INFO    MainThread:232841 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-08-19 01:16:55,535 INFO    MainThread:232841 [wandb_init.py:init():606] backend started and connected
2023-08-19 01:16:55,589 INFO    MainThread:232841 [wandb_init.py:init():697] updated telemetry
2023-08-19 01:16:55,664 INFO    MainThread:232841 [wandb_init.py:init():730] communicating run to backend with 60.0 second timeout
2023-08-19 01:16:56,374 INFO    MainThread:232841 [wandb_run.py:_on_init():2180] communicating current version
2023-08-19 01:16:56,645 INFO    MainThread:232841 [wandb_run.py:_on_init():2189] got version response 
2023-08-19 01:16:56,645 INFO    MainThread:232841 [wandb_init.py:init():781] starting run threads in backend
2023-08-19 01:17:26,899 INFO    MainThread:232841 [wandb_run.py:_console_start():2159] atexit reg
2023-08-19 01:17:26,901 INFO    MainThread:232841 [wandb_run.py:_redirect():2014] redirect: wrap_raw
2023-08-19 01:17:26,901 INFO    MainThread:232841 [wandb_run.py:_redirect():2079] Wrapping output streams.
2023-08-19 01:17:26,901 INFO    MainThread:232841 [wandb_run.py:_redirect():2104] Redirects installed.
2023-08-19 01:17:27,125 INFO    MainThread:232841 [wandb_init.py:init():822] run started, returning control to user process
